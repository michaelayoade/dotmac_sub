{#
   Data Table Component
   Usage: {% include "components/data/table.html" %}

   Parameters:
   - columns: List of {key, label, sortable, class} dicts
   - htmx_url: URL for HTMX requests
   - htmx_target: Target element ID for HTMX swaps
   - create_url: URL for create button
   - create_label: Label for create button
   - search_placeholder: Search input placeholder
   - current_order_by: Current sort column
   - current_order_dir: Current sort direction (asc/desc)
#}
<div class="overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-800">
    <!-- Table Header Controls -->
    <div class="flex flex-col gap-4 border-b border-slate-200 p-4 dark:border-slate-700 sm:flex-row sm:items-center sm:justify-between">
        <!-- Search -->
        <div class="relative">
            <input type="search"
                   name="search"
                   placeholder="{{ search_placeholder | default('Search...') }}"
                   {% if htmx_url %}
                   hx-get="{{ htmx_url }}"
                   hx-trigger="input changed delay:300ms, search"
                   hx-target="#{{ htmx_target | default('table-body') }}"
                   hx-include="[name='order_by'],[name='order_dir']"
                   {% endif %}
                   class="w-full rounded-lg border border-slate-300 bg-slate-50 py-2 pl-10 pr-4 text-sm placeholder-slate-400 focus:border-primary-500 focus:bg-white focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:placeholder-slate-500 dark:focus:bg-slate-800 sm:w-64" />
            <svg class="absolute left-3 top-2.5 h-4 w-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
        </div>

        <!-- Actions -->
        <div class="flex items-center gap-2">
            {% block table_actions %}
            {% if create_url %}
            <a href="{{ create_url }}"
               class="inline-flex items-center gap-2 rounded-lg bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-slate-800">
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
                {{ create_label | default('Add New') }}
            </a>
            {% endif %}
            {% endblock %}
        </div>
    </div>

    <!-- Hidden inputs for sorting -->
    <input type="hidden" name="order_by" value="{{ current_order_by | default('created_at') }}" />
    <input type="hidden" name="order_dir" value="{{ current_order_dir | default('desc') }}" />

    <!-- Table -->
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-slate-200 dark:divide-slate-700">
            <thead class="bg-slate-50 dark:bg-slate-900/50">
                <tr>
                    {% for col in columns %}
                    <th scope="col"
                        {% if col.sortable %}
                        aria-sort="{{ 'ascending' if current_order_by == col.key and current_order_dir == 'asc' else 'descending' if current_order_by == col.key and current_order_dir == 'desc' else 'none' }}"
                        {% endif %}
                        class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400 {{ col.class | default('') }}">
                        {% if col.sortable and htmx_url %}
                        <button hx-get="{{ htmx_url }}?order_by={{ col.key }}&order_dir={{ 'desc' if current_order_by == col.key and current_order_dir == 'asc' else 'asc' }}"
                                hx-target="#{{ htmx_target | default('table-body') }}"
                                hx-include="[name='search']"
                                aria-label="Sort by {{ col.label }}{% if current_order_by == col.key %} ({{ 'descending' if current_order_dir == 'asc' else 'ascending' }}){% endif %}"
                                class="flex items-center gap-1 hover:text-slate-700 dark:hover:text-slate-200">
                            {{ col.label }}
                            {% if current_order_by == col.key %}
                            <svg class="h-4 w-4 {{ 'rotate-180' if current_order_dir == 'asc' else '' }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                            {% else %}
                            <svg class="h-4 w-4 opacity-0 group-hover:opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                            </svg>
                            {% endif %}
                        </button>
                        {% else %}
                        {{ col.label }}
                        {% endif %}
                    </th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody id="{{ htmx_target | default('table-body') }}"
                   class="divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-800">
                {% block table_body %}{% endblock %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    {% block table_pagination %}{% endblock %}
</div>
